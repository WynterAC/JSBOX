# Dark Mode

The latest JSBox version has supported Dark Mode, not only for the app itself, but also provided some easy-to-use APIs for creating dark-mode-perfect scripts.

This chapter talks about how does it work, and how to make your scripts Dark Mode ready.

# theme

`theme` specifies the appearance preference, its possible values are `light` / `dark` / `auto`, stand for light mode, dark mode and system default.

It can be a global setting like this:

```js
$app.theme = "auto";
```

Alternatively, uses the value in the [config.json](en/package/intro.md) file:

```json
{
  "settings": {
    "theme": "auto"
  }
}
```

Other than set that globally, you can also set a certain value for each screens, in its `props`:

```js
$ui.push({
  props: {
    "theme": "light"
  }
});
```

We can also override theme for a certain view like this:

```js
$ui.render({
  views: [
    {
      type: "view",
      props: {
        "theme": "light"
      }
    }
  ]
});
```

> Note, to avoid breaking your existing scripts, the default value of `theme` would be `light`. If you'd like to adapt dark mode, turn it to `auto`, then adjust your colors.

Default controls have different colors under different themes, please refer to the latest [UIKit-Catalog](https://github.com/cyanzhong/xTeko/blob/master/extension-scripts/uikit-catalog.js) demo for more information.

# Dynamic Colors

In order support different colors for light and dark, you can now create dynamic colors like this:

```js
const dynamicColor = $color({
  light: "#FFFFFF",
  dark: "#000000"
});
```

It can also be simplified as:

```js
const dynamicColor = $color("#FFFFFF", "#000000");
```

Colors can be nested, it can use colors generated by the `$rgba(...)` method:

```js
const dynamicColor = $color($rgba(0, 0, 0, 1), $rgba(255, 255, 255, 1));
```

Besides, if you want to provide colors for the pure black theme, you can do:

```js
const dynamicColor = $color({
  light: "#FFFFFF",
  dark: "#141414",
  black: "#000000"
});
```

Dynamic colors show different colors in light mode or dark mode, no need to observe theme changes and switch them manually.

Also, there are some [semantic colors](en/function/index.md?id=colorstring), you can use them directly.

# Dynamic Images

Similarly, you may need to provide dynamic images for light or dark mode, like this:

```js
const dynamicImage = $image({
  light: "light-image.png",
  dark: "dark-image.png"
});
```

This image chooses different resources for light and dark mode, it switches automatically, can be simplified as:

```js
const dynamicImage = $image("light-image.png", "dark-image.png");
```

Besides, images can also be nested, such as:

```js
const lightImage = $image("light-image.png");
const darkImage = $image("dark-image.png");
const dynamicImage = $image(lightImage, darkImage);
```

> Note, this doesn't work for SF Symbols and remote resources. For SF Symbols, please provide dynamic color for `tintColor` to achieve that

# events: themeChanged

Theme changes will emit a `themeChanged` event for all views:

```js
$ui.render({
  views: [
    {
      type: "view",
      layout: $layout.fill,
      events: {
        themeChanged: (sender, isDarkMode) => {
          // Update UI if needed
        }
      }
    }
  ]
});
```

This provides a chance to change some UI details dynamically, such as changing its `alpha` value, or changing its `borderColor` (it doesn't support dynamic colors).

# Blur Effect

In iOS 13 and above, [type: "blur"](en/component/blur.md) supports more styles. Some of those styles are designed for both light mode and dark mode, you can use [$blurStyle](en/data/constant.md?id=blurstyle) for that.

Please refer to Apple's [documentation](https://developer.apple.com/documentation/uikit/uiblureffectstyle) for more information.

# WebView

WebView has its own mechanism for Dark Mode, please refer to [WebKit docs](https://webkit.org/blog/8840/dark-mode-support-in-webkit/) for more information.

Just a tip: for WebViews in JSBox, you need to set `props: opaque` to `false`, this can avoid the whitescreen for the initial loading.

# Embrace Dark Mode

In general, there are three things you should do:

- Set `theme` to `auto`
- Use `$color(light, dark)` and `$image(light, dark)` to create dynamic assets
- Leverage `themeChanged` to update UI details

In order to demonstrate how it works clearly, we prepared an example project for you: https://github.com/cyanzhong/jsbox-dark-mode

As the mechanism continues to improve, we may provide more APIs in the future, which should make your life easier. Besides, the default value of `theme` is just a temporary solution for the transition period, it might be `auto` in the future, to make scripts that only use default controls support dark mode by default.